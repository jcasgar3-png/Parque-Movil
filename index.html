<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Parque M√≥vil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root{
      --blue:#004a98;
      --blue-light:#e2ecf7;
      --bg:#f5f5f7;
      --border:#d3d7dd;
      --text:#111827;
      --muted:#6b7280;
      --yellow:#fde68a;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:var(--bg);
      color:var(--text);
    }
    header{
      background:var(--blue);
      color:#fff;
      padding:.75rem 1rem;
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size:.95rem;
    }
    header .title{
      font-weight:600;
    }
    header .subtitle{
      font-size:.75rem;
      opacity:.9;
    }
    header .user-chip{
      font-size:.75rem;
      padding:.15rem .6rem;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.7);
    }

    main{
      max-width:480px;
      margin:0 auto;
      padding:1rem;
      padding-bottom:2.5rem;
    }

    .screen{display:none;}
    .screen.active{display:block;}

    h1{
      font-size:1.25rem;
      margin:.2rem 0 .8rem;
    }
    h2{
      font-size:1.05rem;
      margin:0 0 .4rem;
    }

    .card{
      background:#fff;
      border-radius:14px;
      border:1px solid var(--border);
      padding:1rem 1.1rem;
      margin-bottom:1rem;
      box-shadow:0 2px 4px rgba(15,23,42,.06);
    }

    .label{
      display:block;
      font-size:.85rem;
      margin-top:.6rem;
      margin-bottom:.2rem;
    }

    .input,.select,.textarea{
      width:100%;
      padding:.55rem .7rem;
      border-radius:8px;
      border:1px solid var(--border);
      font-size:.9rem;
      background:#fff;
    }
    .input:focus,.select:focus,.textarea:focus{
      outline:2px solid var(--blue);
      outline-offset:1px;
    }
    .textarea{resize:vertical;}

    .btn{
      border-radius:999px;
      padding:.65rem 1.3rem;
      font-size:.9rem;
      border:none;
      cursor:pointer;
    }
    .btn-primary{
      background:var(--blue);
      color:#fff;
    }
    .btn-secondary{
      background:#fff;
      border:1px solid var(--border);
    }
    .btn-ghost{
      background:transparent;
      border:none;
      color:var(--blue);
      font-size:.85rem;
    }
    .btn-full{width:100%;}

    .muted{
      font-size:.85rem;
      color:var(--muted);
    }

    .check-row{
      margin-top:.4rem;
      font-size:.85rem;
      color:var(--muted);
    }
    .check-row input{
      margin-right:.35rem;
    }

    /* MEN√ö PRINCIPAL */
    .menu-grid{
      display:flex;
      flex-direction:column;
      gap:.75rem;
    }
    .menu-card{
      text-align:left;
      border-radius:12px;
      border:1px solid var(--border);
      background:#fff;
      padding:.9rem 1rem;
      cursor:pointer;
      display:flex;
      flex-direction:column;
      gap:.15rem;
    }
    .menu-card p{
      margin:0;
      font-size:.8rem;
      color:var(--muted);
    }

    /* LISTADO SERVICIOS */
    .filter-bar{
      display:flex;
      align-items:flex-end;
      gap:.5rem;
      margin-bottom:.75rem;
    }
    .service{
      background:#fff;
      border-radius:12px;
      border:1px solid var(--border);
      padding:.8rem .9rem;
      font-size:.9rem;
      margin-bottom:.6rem;
    }
    .service-head{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:.25rem;
    }
    .hour{
      padding:.2rem .6rem;
      border-radius:999px;
      border:1px solid var(--border);
      font-size:.75rem;
    }
    .status{
      font-size:.75rem;
      padding:.15rem .55rem;
      border-radius:999px;
      background:var(--yellow);
    }
    .service-body{
      color:var(--muted);
      font-size:.85rem;
    }
    .service-foot{
      margin-top:.3rem;
      display:flex;
      justify-content:space-between;
      font-size:.8rem;
    }
    .link{
      color:var(--blue);
      cursor:pointer;
    }

    /* FORM SOLICITUDES */
    .grid-2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:.5rem;
    }
  </style>
</head>

<body>
<header>
  <div>
    <div class="title">Gobierno de Canarias</div>
    <div class="subtitle" id="header-sub">Sistema Centralizado de Autenticaci√≥n</div>
  </div>
  <div id="header-user" class="user-chip" style="display:none;"></div>
</header>

<main>

  <!-- üü¶ PANTALLA 1: LOGIN -->
  <section id="scr-login" class="screen active">
    <div class="card">
      <h1>Sistema Centralizado de Autenticaci√≥n</h1>

      <label class="label" for="usuario">Usuario / NIF/NIE</label>
      <input id="usuario" class="input" type="text" placeholder="12345678Z" />

      <label class="label" for="contrasena">Contrase√±a</label>
      <input id="contrasena" class="input" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />

      <div class="check-row">
        <label>
          <input id="chk-remember" type="checkbox" checked />
          Recordar usuario y contrase√±a
        </label>
      </div>
      <div class="check-row">
        <label>
          <input id="chk-showpass" type="checkbox" />
          Mostrar contrase√±a
        </label>
      </div>

      <button id="btn-login" class="btn btn-primary btn-full" style="margin-top:.9rem;">
        Iniciar sesi√≥n
      </button>

      <p class="muted" style="margin-top:.7rem;">
        Las credenciales se guardan s√≥lo en este dispositivo si marcas "Recordar".
      </p>
    </div>
  </section>

  <!-- üü¶ PANTALLA 2: MEN√ö PARQUE M√ìVIL -->
  <section id="scr-menu" class="screen">
    <h1>Parque M√≥vil</h1>
    <p class="muted" id="menu-saludo"></p>

    <div class="card">
      <div class="menu-grid">
        <button class="menu-card" data-target="scr-solicitudes">
          <div><strong>Gesti√≥n de Solicitudes</strong></div>
          <p>Consulta, crea y administra solicitudes de servicio.</p>
        </button>

        <button class="menu-card" data-target="scr-avisos">
          <div><strong>Gesti√≥n de Avisos</strong></div>
          <p>Revisa avisos relacionados con solicitudes y servicios.</p>
        </button>

        <button class="menu-card" data-target="scr-servicios">
          <div><strong>Listado de Servicios</strong></div>
          <p>Consulta los servicios asignados como conductor.</p>
        </button>
      </div>
    </div>

    <button id="btn-logout" class="btn btn-ghost" style="margin-top:.8rem;">
      Cerrar sesi√≥n
    </button>
  </section>

  <!-- üü¶ PANTALLA 3: LISTADO DE SERVICIOS -->
  <section id="scr-servicios" class="screen">
    <h1>Listado de Servicios</h1>

    <div class="filter-bar">
      <div style="flex:1;">
        <label class="label" for="svc-date">Fecha</label>
        <input id="svc-date" type="date" class="input" />
      </div>
      <button id="btn-svc-buscar" class="btn btn-primary">
        Buscar
      </button>
    </div>

    <div id="svc-list"></div>
    <p id="svc-empty" class="muted" style="display:none;">
      No existen servicios para la fecha seleccionada.
    </p>

    <button class="btn btn-ghost" style="margin-top:.8rem;" data-target="scr-menu">
      Volver al men√∫
    </button>
  </section>

  <!-- üü¶ PANTALLA 4: GESTI√ìN DE SOLICITUDES -->
  <section id="scr-solicitudes" class="screen">
    <h1>Gesti√≥n de Solicitudes</h1>

    <div class="card">
      <label class="label">N¬∫ Solicitud</label>
      <input class="input" type="text" />

      <div class="grid-2">
        <div>
          <label class="label">Fecha Solicitud Desde</label>
          <input class="input" type="date" />
        </div>
        <div>
          <label class="label">Fecha Solicitud Hasta</label>
          <input class="input" type="date" />
        </div>
      </div>

      <div class="grid-2">
        <div>
          <label class="label">Fecha Servicio Desde</label>
          <input class="input" type="date" />
        </div>
        <div>
          <label class="label">Fecha Servicio Hasta</label>
          <input class="input" type="date" />
        </div>
      </div>

      <label class="label">Tipo Servicio</label>
      <select class="select">
        <option value="">(Todos)</option>
        <option>Ordinario</option>
        <option>Coche compartido</option>
        <option>Representaci√≥n oficial</option>
      </select>

      <label class="label">Motivo</label>
      <textarea class="textarea" rows="2"></textarea>

      <div class="check-row" style="margin-top:.6rem;">
        <label><input type="checkbox" /> Servicio extraordinario</label>
      </div>
      <div class="check-row">
        <label><input type="checkbox" /> Servicio de inspecci√≥n</label>
      </div>

      <div style="display:flex;justify-content:flex-end;gap:.5rem;margin-top:.8rem;">
        <button class="btn btn-secondary">Limpiar</button>
        <button class="btn btn-primary">Buscar</button>
      </div>
    </div>

    <p class="muted">No existen solicitudes que se ajusten a los criterios indicados (demo).</p>

    <button class="btn btn-ghost" data-target="scr-menu" style="margin-top:.8rem;">
      Volver al men√∫
    </button>
  </section>

  <!-- üü¶ PANTALLA 5: AVISOS (simple demo) -->
  <section id="scr-avisos" class="screen">
    <h1>Gesti√≥n de Avisos</h1>
    <div class="card">
      <p class="muted">M√≥dulo en modo demostraci√≥n.</p>
    </div>
    <button class="btn btn-ghost" data-target="scr-menu" style="margin-top:.8rem;">
      Volver al men√∫
    </button>
  </section>

  <!-- üü¶ DETALLE DE SERVICIO (opcional, para cuando pulses "Ver detalle") -->
  <section id="scr-detalle" class="screen">
    <h1>Detalle de Servicio</h1>

    <div class="card">
      <p><strong>Parte N¬∫:</strong> <span id="det-parte"></span></p>
      <p><strong>Fecha:</strong> <span id="det-fecha"></span></p>
      <p><strong>Hora:</strong> <span id="det-hora"></span></p>
      <p><strong>Isla:</strong> <span id="det-isla"></span></p>
      <p><strong>Tipo servicio:</strong> <span id="det-tipo"></span></p>
      <p><strong>Veh√≠culo:</strong> <span id="det-veh"></span></p>
      <p><strong>Motivo:</strong></p>
      <p id="det-motivo" class="muted"></p>
      <p><strong>Ocupantes / Organismos:</strong></p>
      <ul id="det-ocup"></ul>
    </div>

    <button class="btn btn-secondary" data-target="scr-servicios">
      Volver al listado
    </button>
  </section>

</main>

<script>
  const $ = (id) => document.getElementById(id);

  // Datos de ejemplo para el Listado de Servicios
  const serviciosDemo = [
    {
      id: "33992",
      fecha: "2025-11-14",
      hora: "07:30",
      isla: "Gran Canaria",
      tipo: "M√öLTIPLES IRA",
      vehiculo: "COCHE COMPARTIDO",
      motivo: "Buenos d√≠as, se modifica el conductor asignado por motivos organizativos. Saludos.",
      ocupantes: [
        "VICENTE FERN√ÅNDEZ - OLIVA SANTANA",
        "J/SRV SEGURIDAD INDUSTRIAL",
        "LOS RODEOS TENERIFE NORTE"
      ],
      estado: "ESPERAR"
    },
    {
      id: "33993",
      fecha: "2025-11-14",
      hora: "07:30",
      isla: "Gran Canaria",
      tipo: "OTRO",
      vehiculo: "COCHE COMPARTIDO",
      motivo: "‚Äî",
      ocupantes: ["JUAN CARLOS OSORIO D√çAZ"],
      estado: "ESPERAR"
    }
  ];

  let usuarioSesion = null;
  let servicioSeleccionado = null;

  function showScreen(id){
    document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
    $(id).classList.add("active");

    const sub = $("header-sub");
    const map = {
      "scr-login":"Sistema Centralizado de Autenticaci√≥n",
      "scr-menu":"Parque M√≥vil ‚Äî Men√∫ principal",
      "scr-servicios":"Parque M√≥vil ‚Äî Listado de Servicios",
      "scr-solicitudes":"Parque M√≥vil ‚Äî Gesti√≥n de Solicitudes",
      "scr-avisos":"Parque M√≥vil ‚Äî Gesti√≥n de Avisos",
      "scr-detalle":"Parque M√≥vil ‚Äî Detalle de Servicio"
    };
    sub.textContent = map[id] || "Parque M√≥vil";
  }

  function rellenarFechaHoy(){
    const hoy = new Date();
    const y = hoy.getFullYear();
    const m = String(hoy.getMonth()+1).padStart(2,"0");
    const d = String(hoy.getDate()).padStart(2,"0");
    $("svc-date").value = `${y}-${m}-${d}`;
  }

  function renderServicios(fecha){
    const cont = $("svc-list");
    cont.innerHTML = "";
    const lista = serviciosDemo.filter(s => s.fecha === fecha);
    const empty = $("svc-empty");

    if(!lista.length){
      empty.style.display = "block";
      return;
    }
    empty.style.display = "none";

    lista.forEach(s => {
      const div = document.createElement("div");
      div.className = "service";
      div.innerHTML = `
        <div class="service-head">
          <span class="hour">${s.hora}</span>
          <span class="status">${s.estado}</span>
        </div>
        <div class="service-body">
          <div><strong>${s.isla}</strong></div>
          <div>Tipo servicio: ${s.tipo}</div>
          <div>Veh√≠culo: ${s.vehiculo}</div>
        </div>
        <div class="service-foot">
          <span>Parte N¬∫ ${s.id}</span>
          <span class="link" data-id="${s.id}">Ver detalle ></span>
        </div>
      `;
      cont.appendChild(div);
    });

    cont.querySelectorAll(".link[data-id]").forEach(a => {
      a.addEventListener("click", () => {
        const id = a.getAttribute("data-id");
        const srv = serviciosDemo.find(x => x.id === id);
        if(srv){
          servicioSeleccionado = srv;
          mostrarDetalleServicio(srv);
          showScreen("scr-detalle");
        }
      });
    });
  }

  function mostrarDetalleServicio(s){
    $("det-parte").textContent = s.id;
    $("det-fecha").textContent = s.fecha;
    $("det-hora").textContent = s.hora;
    $("det-isla").textContent = s.isla;
    $("det-tipo").textContent = s.tipo;
    $("det-veh").textContent = s.vehiculo;
    $("det-motivo").textContent = s.motivo || "‚Äî";
    const ul = $("det-ocup");
    ul.innerHTML = "";
    (s.ocupantes || []).forEach(o => {
      const li = document.createElement("li");
      li.textContent = o;
      ul.appendChild(li);
    });
  }

  function cargarCredencialesGuardadas(){
    const u = localStorage.getItem("pm_usuario");
    const p = localStorage.getItem("pm_pass");

    if(u){
      $("usuario").value = u;
      $("chk-remember").checked = true;
    } else {
      $("chk-remember").checked = false;
    }
    if(p){
      $("contrasena").value = p;
    }
  }

  function guardarCredenciales(u,p){
    if($("chk-remember").checked){
      localStorage.setItem("pm_usuario", u);
      localStorage.setItem("pm_pass", p);
    } else {
      localStorage.removeItem("pm_usuario");
      localStorage.removeItem("pm_pass");
    }
  }

  function actualizarHeaderUser(){
    const el = $("header-user");
    if(usuarioSesion){
      el.style.display = "inline-block";
      el.textContent = usuarioSesion;
    } else {
      el.style.display = "none";
      el.textContent = "";
    }
  }

  document.addEventListener("DOMContentLoaded", () => {
    // Cargar credenciales guardadas
    cargarCredencialesGuardadas();

    // Toggle mostrar contrase√±a
    $("chk-showpass").addEventListener("change", () => {
      $("contrasena").type = $("chk-showpass").checked ? "text" : "password";
    });

    // Login
    $("btn-login").addEventListener("click", () => {
      const u = $("usuario").value.trim();
      const p = $("contrasena").value.trim();
      if(!u || !p){
        alert("Introduce usuario y contrase√±a.");
        return;
      }
      usuarioSesion = u;
      guardarCredenciales(u,p);
      $("menu-saludo").textContent = "Bienvenido, " + u;
      actualizarHeaderUser();
      showScreen("scr-menu");
    });

    // Logout
    $("btn-logout").addEventListener("click", () => {
      usuarioSesion = null;
      actualizarHeaderUser();
      showScreen("scr-login");
    });

    // Navegaci√≥n por data-target
    document.querySelectorAll("[data-target]").forEach(btn => {
      btn.addEventListener("click", () => {
        const t = btn.getAttribute("data-target");
        showScreen(t);
      });
    });

    // Servicios
    rellenarFechaHoy();
    renderServicios($("svc-date").value);
    $("btn-svc-buscar").addEventListener("click", () => {
      renderServicios($("svc-date").value);
    });
  });
</script>

</body>
</html>
